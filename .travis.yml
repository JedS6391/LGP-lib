language: java
matrix:
  include:
  - os: linux
    sudo: false
    jdk: oraclejdk8
    addons:
      apt:
        packages:
        - oracle-java8-installer
        - oracle-java8-set-default
env:
  global:
  - REAL_BRANCH=$(git ls-remote origin | sed -n "\|$TRAVIS_COMMIT\s\+refs/heads/|{s///p}")
before_cache:
- rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
- rm -fr $HOME/.gradle/caches/*/plugin-resolution/
cache:
  directories:
  - "$HOME/.gradle/caches/"
  - "$HOME/.gradle/wrapper/"
before_install:
- chmod -R ug+x .travis
script:
- chmod -R ug+x .travis
- ".travis/build.sh"
before_deploy: bash .travis/deploy.sh $REAL_BRANCH $TRAVIS_TAG
deploy:
  provider: releases
  api_key:
    secure: "JYpe8b5CPHmOVYSkAJZJwkvbfL1YStK23f1Q0lr3O5SyFLZogk8DdX5dOem6uolAaA9hj7hhjXTgWJm6GxyQ+a82+5toMK6+dkCsriICbVVvq97XFiQvGCdVAfG32TkNumEPqxJgWBPzlhCgpWQuKIoMgpcFVgCL/94Ec3wzzL8dz/iL8N7U9Xj5nTH1joHKudPldMq0NO0gYyBlwWMnzj1TJcgj48ITV6e3BMjT9MPK/JJP+ODlXEgGdXWqVJfme+8UdT8Y10d85JgupkpU5dOaRDw/pi8//jofX4IG29MQ/UrsPMIg44h+/nUeopCyMNOvxq55FjzkYDvCQRMJ9o9hK6bBm/rApqWLa98Bwj/LyJZceSXMKyrprIYJVJm1GLE61jV45A84eSnfnoMLpkDSTqUgL1rSwigFKsCsi5R7LvJZx7UxbLxPPoK/ADx221vi5BC7wIwgDJVxoWGU299RgKS7Kek5uzDVOFfX8vuGt5hnnjQX2WgHFEWJSePJPTRRiZxHdOtxIR7SmcjCntXfkhATfzGLpnZ0IclcIyVSK0MA2uH0HfWlrbrL2mXY0hexb7m4wNDooXXYDh1K8zDvhmZcP68uhzMvVh4OYYwPp7SSkTi5LKRspcklaTvireZLWMlnjRvsOgjMN5MHUZ/3SbsXaupIfTJSb1v/0VI="
  file:
    - build/libs/LGP-lib-$TRAVIS_TAG-$(date +%Y-%m-%d).jar
  skip_cleanup: true
  overwrite: true
  on:
    repo: JedS6391/LGP-lib
    all_branches: true
    condition: "$REAL_BRANCH =~ ^release.*$"
    tags: true
